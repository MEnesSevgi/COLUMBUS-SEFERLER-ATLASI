<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>COLUMBUS SEFERLERÄ° ATLASI</title>
    

  </head>
    
  <body>
  <!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>KOLOMB ATLASI | Sefer BazlÄ± NumaralandÄ±rma</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Quicksand:wght@300;500&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #1a1a1a; --accent: #d4af37; --ocean: #1e3d59; --glass: rgba(255, 255, 255, 0.95); }
        body, html { margin: 0; padding: 0; height: 100%; width: 100%; font-family: 'Quicksand', sans-serif; background: #000; overflow: hidden; }
        
        .viewport { display: grid; grid-template-columns: 1fr 400px; height: 100vh; }

        @media (max-width: 1024px) {
            .viewport { grid-template-columns: 1fr; 
              grid-template-columns: 1fr;
          grid-template-rows: 45dvh 55dvh; 
        height: 100dvh;}
            #sidebar { height: 100% !important; border-left: none !important; border-top: 3px solid var(--accent); display: flex;
        flex-direction: column;
        overflow: hidden; /* DÄ±ÅŸarÄ± taÅŸmayÄ± engelle */ }
           .sidebar-header h1 { font-size: 1rem; padding: 5px; }
    #event-img { max-height: 120px; } /* Resim boyutu mobilde biraz kÃ¼Ã§Ã¼ltÃ¼ldÃ¼ */ 
        }

        #map { background: var(--ocean); z-index: 1; position: relative; }
        
        .search-hud { position: absolute; top: 15px; left: 50%; transform: translateX(-50%); z-index: 1001; width: 90%; max-width: 550px; background: var(--glass); padding: 5px; border-radius: 50px; box-shadow: 0 5px 20px rgba(0,0,0,0.3); border: 1px solid var(--accent); }
        .search-hud select { width: 100%; border: none; background: transparent; padding: 10px; font-family: 'Cinzel', serif; font-weight: bold; font-size: 12px; outline: none; }
        
        #sidebar { background: white; border-left: 4px solid var(--accent); display: flex; flex-direction: column; z-index: 1002; height: 100vh; overflow: hidden; }
        .sidebar-header { padding: 15px; background: var(--primary); color: var(--accent); text-align: center; font-family: 'Cinzel', serif; flex-shrink: 0; }
        .content-scroll { padding: 15px; 
        padding-bottom: 80px; /* En alta ekstra boÅŸluk ekledik */
        overflow-y: auto; 
        -webkit-overflow-scrolling: touch; }
        
        #event-title { font-family: 'Cinzel', serif; color: var(--primary); margin: 0; font-size: 18px; }
        .voyage-chip { display: inline-block; padding: 3px 10px; border-radius: 4px; color: white; font-size: 10px; font-weight: bold; margin-bottom: 8px; }
        .description { font-size: 13px; line-height: 1.5; color: #333; margin-bottom: 10px; }
        #event-img { width: 100%; border-radius: 8px; margin-bottom: 10px; display: none; max-height: 150px; object-fit: cover; }
        .wiki-card { background: #fdfaf0; border: 1px solid #eee; padding: 10px; border-radius: 6px; font-size: 12px; color: #555; }
        
        .play-btn { background: #27ae60; color: white; border: none; width: 100%; padding: 12px; border-radius: 6px; font-family: 'Cinzel', serif; font-weight: bold; cursor: pointer; margin-bottom: 10px; transition: 0.3s; }
        .play-btn:disabled { background: #95a5a6; }

        .compass-marker { background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 2px solid; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .marker-label { background: rgba(255, 255, 255, 0.9) !important; border: 1px solid var(--accent) !important; font-weight: bold !important; color: #000 !important; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
    </style>
</head>
<body>

<div class="viewport">
    <div id="map">
        <div class="search-hud">
            <select id="eventSelect">
                <option value="RESET">ðŸ§­ SEFER SEÃ‡Ä°N</option>
                <optgroup label="âš“ SEFERLER" id="routeGroup"></optgroup>
                <optgroup label="ðŸ“ TÃœM DURAKLAR" id="pointGroup"></optgroup>
            </select>
        </div>
    </div>

    <div id="sidebar">
        <div class="sidebar-header"><h1>COLUMBUS SEFERLERÄ° ATLASI</h1></div>
        <div class="content-scroll">
            <button id="playRouteBtn" class="play-btn">ðŸŽ¬ SEFERÄ° SÄ°NEMATÄ°K Ä°ZLE</button>
            <div id="voyage-chip" class="voyage-chip"></div>
            <h2 id="event-title">YÃ¼kleniyor...</h2>
            <div id="event-desc" class="description">Harita hazÄ±rlanÄ±yor...</div>
            <img id="event-img" src="">
            <div id="wiki-box" class="wiki-card">BaÄŸlanÄ±yor...</div>
        </div>
    </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const colors = { "1. SEFER": "#e67e22", "2. SEFER": "#27ae60", "3. SEFER": "#8e44ad", "4. SEFER": "#2980b9", "SÃ–MÃœRGECÄ°LÄ°K": "#c0392b", "Ã–LÃœM": "#2c3e50", "DÄ°PLOMASÄ°": "#7f8c8d" };

// Veri setini olduÄŸu gibi koruyoruz
const dataSet = [
  { name: "Palos de la Frontera", year: "1492", lat: 37.2285, lng: -6.8931, wiki: "Palos_de_la_Frontera", cat: "1. SEFER", desc: "3 AÄŸustos 1492: Kolomb yola Ã§Ä±ktÄ±." },
    { name: "Kanarya AdalarÄ±", year: "1492", lat: 28.2916, lng: -16.6291, wiki: "Canary_Islands", cat: "1. SEFER", desc: "6 AÄŸustos 1492: Pinta'nÄ±n dÃ¼meni kÄ±rÄ±ldÄ±, Kanarya AdalarÄ±'nda onarÄ±ldÄ±." },
    { 
  name: "San Salvador", 
  year: "1492", 
  lat: 24.0450,  // Ä°ki nokta ortalamasÄ± gibi
  lng: -74.5300, 
  wiki: "San_Salvador_Island", 
  cat: "1. SEFER", 
  desc: "12 Ekim 1492: Kolomb'un karaya ayak bastÄ±ÄŸÄ± ilk yer. AynÄ± dÃ¶nemde bazÄ± TaÃ­no yerlileri esir alÄ±narak Ä°spanya'ya gÃ¶tÃ¼rÃ¼ldÃ¼." 
},

    { name: "KÃ¼ba KeÅŸfi", year: "1492", lat: 21.5218, lng: -77.7812, wiki: "KÃ¼ba", cat: "1. SEFER", desc: "Ekim 1492: Kolomb burayÄ± Asya anakarasÄ± sanmÄ±ÅŸtÄ±." },
    { name: "Hispaniola", year: "1492", lat: 19.7500, lng: -72.2000, wiki: "Hispaniola", cat: "1. SEFER", desc: "AralÄ±k 1492: Kolomb dÃ¶nemi ilk kalÄ±cÄ± yerleÅŸim giriÅŸimi Avrupa yerleÅŸimi La Navidad kuruldu." },
   { 
    name: "Ciguayos ile Ã‡atÄ±ÅŸma", 
    year: "1493", 
    lat: 19.0000, 
    lng: -69.0000, 
    wiki: "Ciguayo", 
    cat: "1. SEFER", 
    desc: "1493: Kolomb, Ciguayos adlÄ± yerli halkla ÅŸiddetli bir Ã§atÄ±ÅŸmaya girdi; koya 'Oklar KÃ¶rfezi' adÄ±nÄ± verdi." 
  },

    { name: "Azor AdalarÄ±", year: "1493", lat: 36.9727, lng: -25.1415, wiki: "Azores", cat: "1. SEFER", desc: "Åžubat 1493: DÃ¶nÃ¼ÅŸ yolunda fÄ±rtÄ±nadan kaÃ§Ä±ÅŸ." },
   
  { name: "Lizbon", year: "1493", lat: 38.7223, lng: -9.1393, wiki: "Lisbon", cat: "1. SEFER", desc: "DÃ¶nÃ¼ÅŸ yolunda Ã¶nemli bir liman." },
  
{ 
   name: "Palos (Final DÃ¶nÃ¼ÅŸ)", 
   year: "1493", 
lat: 37.0500,  // Ä°yice aÃ§Ä±ÄŸa, CÃ¡diz KÃ¶rfezi'nin dÄ±ÅŸÄ±na Ã§ekildi
   lng: -7.1500,
   wiki: "Palos_de_la_Frontera", 
   cat: "1. SEFER", 
   desc: "15 Mart 1493: Kolomb ilk seferini baÅŸladÄ±ÄŸÄ± yerin aÃ§Ä±klarÄ±na ulaÅŸarak tamamladÄ±." 
 },
  
    { name: "CÃ¡diz LimanÄ±", year: "1493", lat: 36.5271, lng: -6.2886, wiki: "CÃ¡diz", cat: "2. SEFER", desc: "EylÃ¼l 1493: 17 gemilik dev filoyla hareket." },
  
   { name: "Kanarya AdalarÄ± (2. Sefer)", year: "1493", lat: 28.2916, lng: -16.6291, wiki: "Canary_Islands", cat: "2. SEFER", desc: "Sefer Ã¶ncesi ikmal ve onarÄ±m iÃ§in durak." },
  
    { name: "Dominika", year: "1493", lat: 15.4150, lng: -61.3710, wiki: "Dominica", cat: "2. SEFER", desc: "KÃ¼Ã§Ã¼k Antiller'de Ã¶nemli durak." },
  { name: "Guadeloupe", year: "1493", lat: 16.2650, lng: -61.5510, wiki: "Guadeloupe", cat: "2. SEFER", desc: "KÃ¼Ã§Ã¼k Antiller'de durak." },
  { name: "Antigua", year: "1493", lat: 17.0747, lng: -61.8175, wiki: "Antigua_and_Barbuda", cat: "2. SEFER", desc: "KÃ¼Ã§Ã¼k Antiller'de durak." },
  { name: "Porto Riko (San Juan Bautista)", year: "1493", lat: 18.4655, lng: -66.1057, wiki: "San_Juan,_Puerto_Rico", cat: "2. SEFER", desc: "Kolonizasyonun baÅŸlangÄ±Ã§ noktalarÄ±ndan biri." },
  { name: "La Isabela", year: "1494", lat: 19.8894, lng: -71.0805, wiki: "La_Isabela", cat: "2. SEFER", desc: "Yeni DÃ¼nya'daki ilk idari merkez." },
  
  //
  
 { 
    name: "Guantanamo KÃ¶rfezi (Puerto Grande)", 
    year: "1494", 
    lat: 19.9167, 
    lng: -75.1667, 
    wiki: "GuantÃ¡namo_Bay", 
    cat: "2. SEFER", 
    desc: "Kolomb buraya 'Puerto Grande' adÄ±nÄ± verdi. Gemilerini burada dinlendirdi ve yerlilerle ilk temasÄ± kurdu." 
  },
  { 
    name: "Cabo Cruz (Cape Cruz)", 
    year: "1494", 
    lat: 19.8411, 
    lng: -77.7264, 
    wiki: "Cabo_Cruz", 
    cat: "2. SEFER", 
    desc: "KÃ¼ba'nÄ±n gÃ¼neydoÄŸusundaki en belirgin uÃ§ nokta. Buradan gÃ¼neye saparak Jamaika'yÄ± keÅŸfetti, sonra buraya dÃ¶nÃ¼p hatta devam etti." 
  },
   { name: "Jamaika KeÅŸfi", year: "1494", lat: 18.1096, lng: -77.2975, wiki: "Jamaica", cat: "2. SEFER", desc: "MayÄ±s 1494: AdanÄ±n doÄŸal gÃ¼zelliÄŸi Kolomb'u hayran bÄ±raktÄ±." },
  { 
    name: "Jardines de la Reina (KraliÃ§e BahÃ§eleri)", 
    year: "1494", 
    lat: 20.8167, 
    lng: -78.9167, 
    wiki: "Jardines_de_la_Reina", 
    cat: "2. SEFER", 
    desc: "YÃ¼zlerce kÃ¼Ã§Ã¼k adacÄ±ktan oluÅŸan bu bÃ¶lgeye KraliÃ§e Isabel onuruna bu ismi verdi. Labirent gibi adalar arasÄ±nda ilerlemek Ã§ok gÃ¼Ã§tÃ¼." 
  },

  { 
  name: "BahÃ­a de CortÃ©s (CortÃ©s KÃ¶rfezi)", 
  year: "1494", 
  lat: 22.0333, 
  lng: -84.0000, 
  wiki: "KÃ¼ba",  // Bu sayfa KÃ¼ba kÃ¶rfezleri hakkÄ±nda bilgi verir
  cat: "2. SEFER", 
  desc: "Seyahatin batÄ±daki en uÃ§ noktasÄ±. MÃ¼rettebat yorgunluÄŸu ve erzak azlÄ±ÄŸÄ± nedeniyle buradan geri dÃ¶nme kararÄ± alÄ±ndÄ±." 
},
  { 
    name: "Evangelista (Isla de la Juventud)", 
    year: "1494", 
    lat: 21.6167, 
    lng: -82.8167, 
    wiki: "Isla_de_la_Juventud", 
    cat: "2. SEFER", 
    desc: "DÃ¶nÃ¼ÅŸ yoluna geÃ§meden hemen Ã¶nce ulaÅŸÄ±lan bÃ¼yÃ¼k ada. Isla de la Juventud, KÃ¼ba'nÄ±n 2. ve Karayipler'in 7. bÃ¼yÃ¼k adasÄ±dÄ±r. Kolomb KÃ¼ba'nÄ±n Asya olduÄŸuna inanÄ±yordu." 
  },
  { 
    name: "Jamaika GÃ¼ney KÄ±yÄ±larÄ±", 
    year: "1494", 
    lat: 17.281906466254963, 
    lng: -77.44509007920922, 
    wiki: "Jamaica", 
    cat: "2. SEFER", 
    desc: "DÃ¶nÃ¼ÅŸ yolunda Jamaika'nÄ±n gÃ¼ney kÄ±yÄ±larÄ± keÅŸfedildi."  , 
  },
  { 
    name: "Mona GeÃ§idi (Mona Passage)", 
    year: "1494", 
    lat: 18.3599, 
    lng: -67.8113, 
    wiki: "Mona_Passage", 
    cat: "2. SEFER", 
    desc: "Hispaniola ve Porto Riko arasÄ±ndaki kritik su yolu. Seferin son aÅŸamasÄ±na girildi." 
  },
  
   { name: "CÃ¡diz LimanÄ±", year: "1493", lat:36.69356623637789, lng: -6.816330228758719, wiki: "CÃ¡diz", cat: "2. SEFER", desc: "2. seferin son duraÄŸÄ±" },
  
 

 
  
  
  
  
  
   
  
   
    { name: "Tordesillas HattÄ±", year: "1494", lat: 25.0000, lng: -46.0000, wiki: "Tordesillas_AntlaÅŸmasÄ±", cat: "DÄ°PLOMASÄ°", desc: "Ä°spanya ve Portekiz arasÄ±nda yeni keÅŸfedilen topraklarÄ±n paylaÅŸÄ±mÄ± iÃ§in belirlenen sÄ±nÄ±r hattÄ±." },
    
  { name: "AltÄ±n HaraÃ§ Sistemi", year: "1495", lat: 19.8894, lng: -71.0805, wiki: "Encomienda", cat: "SÃ–MÃœRGECÄ°LÄ°K", desc: "Yerlilerden zorla altÄ±n alÄ±nmasÄ± ve ellerin kesilmesi gibi cezalar uygulanmasÄ±." },
   { 
    name: "SanlÃºcar", 
    year: "1498", 
    lat: 36.7781, 
    lng: -6.3531, 
    wiki: "SanlÃºcar_de_Barrameda", 
    cat: "3. SEFER", 
    desc: "MayÄ±s 1498: AltÄ± gemiyle GÃ¼ney Amerika'ya doÄŸru yola Ã§Ä±kÄ±ldÄ±." 
  },
  { 
    name: "Madeira AdalarÄ±", 
    year: "1498", 
    lat: 32.7604, 
    lng: -16.9595, 
    wiki: "Madeira", 
    cat: "3. SEFER", 
    desc: "Portekiz adalarÄ±nda ikmal ve su takviyesi." 
  },
  { 
    name: "Kanarya AdalarÄ± (3. Sefer)", 
    year: "1498", 
    lat: 28.2916, 
    lng: -16.6291, 
    wiki: "Canary_Islands", 
    cat: "3. SEFER", 
    desc: "Geleneksel durak" 
  },
  { 
    name: "Cape Verde (YeÅŸil Burun)", 
    year: "1498", 
    lat: 14.9177, 
    lng: -23.5092, 
    wiki: "Cape_Verde", 
    cat: "3. SEFER", 
    desc: "En gÃ¼neydeki Ã§Ä±kÄ±ÅŸ noktasÄ±. Buradan sonra aÃ§Ä±k okyanusa, ekvator Ã§izgisine doÄŸru ilerlendi." 
  },
  { 
    name: "Trinidad AdasÄ±", 
    year: "1498", 
    lat: 10.4500, 
    lng: -61.2000, 
    wiki: "Trinidad", 
    cat: "3. SEFER", 
    desc: "AÄŸustos 1498: ÃœÃ§ tepeli bir daÄŸ gÃ¶rdÃ¼ÄŸÃ¼ iÃ§in adaya 'ÃœÃ§leme' (Trinidad) adÄ±nÄ± verdi." 
  },
{ 
    name: "Orinoco Etkisi (Paria KÃ¶rfezi)", 
    year: "1498", 
    lat: 10.0500, // Trinidad'Ä±n hemen gÃ¼ney batÄ±sÄ±, kÃ¶rfez giriÅŸi
    lng: -61.9000, 
    wiki: "Orinoco", 
    cat: "3. SEFER", 
    desc: "Okyanus suyunun aniden tatlÄ±laÅŸmasÄ±yla devasa bir nehrin (Orinoco) varlÄ±ÄŸÄ± keÅŸfedildi." 
  },
  { 
    name: "Boca del Drago (Ejderha AÄŸzÄ±)", 
    year: "1498", 
    lat: 10.7500, 
    lng: -61.8500, 
    wiki: "Gulf_of_Paria", 
    cat: "3. SEFER", 
    desc: "Trinidad ile GÃ¼ney Amerika (Venezuela) arasÄ±ndaki dar geÃ§it. Kolomb burada devasa tatlÄ± su akÄ±ntÄ±sÄ±nÄ± (Orinoco) keÅŸfetti." 
  },
  
  { 
    name: "Margarita ve Paria", 
    year: "1498", 
    lat: 10.9971, 
    lng: -63.9113, 
    wiki: "Isla_Margarita", 
    cat: "3. SEFER", 
    desc: "Ä°ncileriyle Ã¼nlÃ¼ Margarita AdasÄ± ve ana kara kÄ±yÄ±larÄ± keÅŸfedildi." 
  },
  { 
    name: "Hispaniola GÃ¼neyi", 
    year: "1498", 
    lat: 17.5000, 
    lng: -71.5000, 
    wiki: "Hispaniola", 
    cat: "3. SEFER", 
    desc: "GÃ¼neyden yaklaÅŸÄ±larak adanÄ±n gÃ¼ney sahilleri boyunca ilerlendi." 
  },

  { 
    name: "Santo Domingo", 
    year: "1500", 
    lat: 18.4861, 
    lng: -69.9312, 
    wiki: "Santo_Domingo", 
    cat: "3. SEFER", 
    desc: "Kolomb, buradaki isyanlar ve kÃ¶tÃ¼ yÃ¶netim suÃ§lamalarÄ±yla tutuklanarak zincire vurulmuÅŸ halde Ä°spanya'ya gÃ¶nderildi." 
  },
    { 
    name: "Mona GeÃ§idi (Mona Passage)", 
    year: "1498", 
    lat: 18.3599, 
    lng: -67.8113, 
    wiki: "Mona_Passage", 
    cat: "3. SEFER", 
    desc: "Seferin sonunda Porto Riko ile Hispaniola arasÄ±ndaki bu geÃ§itten geÃ§erek merkeze ulaÅŸÄ±ldÄ±." 
  },
  { 
    name: "CÃ¡diz (DÃ¶nÃ¼ÅŸ)", 
    year: "1500", 
    lat: 36.5271, 
    lng: -6.2886, 
    wiki: "CÃ¡diz", 
    cat: "3. SEFER", 
    desc: "Ekim 1500: Kolomb, zincire vurulmuÅŸ bir mahkum olarak Ä°spanya'ya dÃ¶ndÃ¼. Daha sonra KraliÃ§e tarafÄ±ndan serbest bÄ±rakÄ±ldÄ±." 
  },
  
{ name: "SanlÃºcar / CÃ¡diz", year: "1502", lat: 36.7780, lng: -6.3530, wiki: "CÃ¡diz", cat: "4. SEFER", desc: "9 MayÄ±s 1502: Kolomb son seferine 4 gemi ve 140 kiÅŸiyle baÅŸladÄ±." },
    { 
    name: "Kanarya AdalarÄ± (4. Sefer)", 
    year: "1502", 
    lat: 28.2916, 
    lng: -16.6291, 
    wiki: "Canary_Islands", 
    cat: "4. SEFER", 
    desc: "Geleneksel durak" 
  },

{ name: "Martinique (Mantinuqe)", year: "1502", lat: 14.6415, lng: -61.0242, wiki: "Martinique", cat: "4. SEFER", desc: "Haziran 1502: Atlantik geÃ§iÅŸi sonrasÄ± Yeni DÃ¼nya'daki ilk durak." },

{ name: "Santo Domingo'ya AlÄ±nmama", year: "1502", lat: 17.088416011635374, lng: -69.72480437374125, wiki: "Santo_Domingo", cat: "4. SEFER", desc: "Haziran 1502: Vali Ovando tarafÄ±ndan limana alÄ±nmadÄ±; aÃ§Ä±k denizde kasÄ±rgadan kurtuldu." },  
  
  { name: "Las Tortugas (Cayman)", year: "1503", lat: 19.7692, lng: -79.8709, wiki: "Cayman_Islands", cat: "4. SEFER", desc: "MayÄ±s 1503: Panama'dan dÃ¶nerken akÄ±ntÄ±yla kuzeye savrulup Cayman AdalarÄ±'ndan geÃ§iÅŸ." },

{ 
    name: "Honduras (Guanaja)", 
    year: "1502", 
    lat: 16.4761, 
    lng: -85.8941, 
    wiki: "Guanaja", 
    cat: "4. SEFER", 
    desc: "Temmuz 1502: Jamaika'nÄ±n kuzeyinden geÃ§ip Orta Amerika anakarasÄ±na ulaÅŸtÄ±; Maya tÃ¼ccarlarÄ±yla karÅŸÄ±laÅŸtÄ±." 
  },
  { 
    name: "Nikaragua (Cabo Gracias a Dios)", 
    year: "1502", 
    lat: 15.0016, 
    lng: -83.1476, 
    wiki: "Cape_Gracias_a_Dios", 
    cat: "4. SEFER", 
    desc: "EylÃ¼l 1502: FÄ±rtÄ±nalÄ± bir geÃ§iÅŸin ardÄ±ndan kÄ±yÄ± hattÄ±nÄ±n gÃ¼neye dÃ¶ndÃ¼ÄŸÃ¼ nokta. Kolomb kurtulduÄŸu iÃ§in 'TanrÄ±ya ÅžÃ¼kÃ¼r' ismini verdi." 
  },
  { 
    name: "Kosta Rika (Cariay)", 
    year: "1502", 
    lat: 9.9913, 
    lng: -83.0267, 
    wiki: "Puerto_LimÃ³n", 
    cat: "4. SEFER", 
    desc: "EylÃ¼l 1502: Yerlilerle ilk kez altÄ±n takasÄ±nÄ±n yapÄ±ldÄ±ÄŸÄ± bÃ¶lge (Modern Puerto LimÃ³n)." 
  },
  { 
    name: "Isla Bastimentos (Bocas del Toro)", 
    year: "1502", 
    lat: 9.3448, 
    lng: -82.2452, 
    wiki: "Bocas_del_Toro_Archipelago", 
    cat: "4. SEFER", 
    desc: "Ekim 1502: Panama kÄ±yÄ±larÄ±nda gemi bakÄ±mÄ± yapÄ±ldÄ± ve yerlilerden altÄ±n takas edildi." 
  },
  { 
    name: "Portobelo", 
    year: "1502", 
    lat: 9.5585, 
    lng: -79.6625, 
    wiki: "Portobelo,_Panama", 
    cat: "4. SEFER", 
    desc: "KasÄ±m 1502: Kolomb'un 'GÃ¼zel Liman' adÄ±nÄ± verdiÄŸi korunaklÄ± ana liman." 
  },
  { 
    name: "Retrete (Panama)", 
    year: "1502", 
    lat: 9.4518, 
    lng: -78.6715, 
    wiki: "Panama", 
    cat: "4. SEFER", 
    desc: "KasÄ±m 1502: Panama'da ulaÅŸÄ±lan en uÃ§ nokta; buradan geri dÃ¶nÃ¼ÅŸ ve kuzeye savrulma baÅŸladÄ±." 
  },


{ name: "Jamaika (Kuzey Sahili)", year: "1503", lat: 18.5736, lng: -78.0598, wiki: "Jamaica", cat: "4. SEFER", desc: "Haziran 1503: Gemi kurtlarÄ± nedeniyle delinen gemilerin karaya oturduÄŸu yer; 1 yÄ±l mahsur kaldÄ±." },

{ name: "Mona GeÃ§idi", year: "1504", lat: 18.3142, lng: -67.8999, wiki: "Mona_Passage", cat: "4. SEFER", desc: "EylÃ¼l 1504: Jamaika'dan kurtarÄ±lÄ±p Santo Domingo Ã¼zerinden Ä°spanya'ya dÃ¶nÃ¼ÅŸ rotasÄ±." },
  { name: "SanlÃºcar de Barrameda (Final)", year: "1504", lat: 36.7850, // 36.7781 -> 36.7850 (Hafif kuzey)
  lng: -6.3400, wiki: "SanlÃºcar_de_Barrameda", cat: "4. SEFER", desc: "7 KasÄ±m 1504: Kolomb'un son seferinden bitkin ve hasta halde Ä°spanya'ya kesin dÃ¶nÃ¼ÅŸÃ¼." },
  
    { name: "Ä°lk KÃ¶le SevkiyatÄ±", year: "1505", lat: 18.5000, lng: -70.0000, wiki: "Atlantic_slave_trade", cat: "SÃ–MÃœRGECÄ°LÄ°K", desc: "Trajik kÃ¶le ticaretinin baÅŸlangÄ±cÄ±." },
    { name: "Valladolid", year: "1506", lat: 41.6523, lng: -4.7245, wiki: "Christopher_Columbus", cat: "Ã–LÃœM", desc: "BÃ¼yÃ¼k kaÅŸifin hayata gÃ¶zlerini yummasÄ±." },
];

const map = L.map('map', { zoomControl: false }).setView([20, -40], 3);
L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png').addTo(map);

const select = document.getElementById('eventSelect');
const playBtn = document.getElementById('playRouteBtn');
let currentLines = [];
let markerNodes = [];
let isPlaying = false;

// UI BaÅŸlatma
function init() {
    // Kategori bazlÄ± sayaÃ§ objesi
    const categoryCounters = {};

    dataSet.forEach((d, i) => {
        // Kategori daha Ã¶nce gÃ¶rÃ¼lmediyse sayacÄ± 1 yap, varsa 1 arttÄ±r
        if (!categoryCounters[d.cat]) {
            categoryCounters[d.cat] = 1;
        } else {
            categoryCounters[d.cat]++;
        }

        // Marker oluÅŸtururken mevcut kategori sayÄ±sÄ±nÄ± kullan
        const m = createMarker(d, i, categoryCounters[d.cat]);
        markerNodes.push(m);
        
        const opt = document.createElement('option');
        opt.value = i;
        opt.textContent = `${d.cat}: ${d.name}`;
        document.getElementById('pointGroup').appendChild(opt);
    });

    ["1. SEFER", "2. SEFER", "3. SEFER", "4. SEFER"].forEach(s => {
        const opt = document.createElement('option');
        opt.value = "ROUTE_" + s;
        opt.textContent = `ðŸš¢ ${s}`;
        document.getElementById('routeGroup').appendChild(opt);
    });

    // Ä°LK AÃ‡ILIÅž: 1. SEFER
    drawRoute("1. SEFER");
    updateUI(dataSet[0]);
}

function createMarker(d, globalIndex, categoryIndex) {
    const color = colors[d.cat] || "#333";
    const m = L.marker([d.lat, d.lng], {
        icon: L.divIcon({
            className: 'custom-icon',
            html: `<div class="compass-marker" style="border-color:${color}; color:${color}; width:22px; height:22px; font-size:10px;">${categoryIndex}</div>`
        })
    });
    
    m.bindTooltip(d.name, { 
        permanent: true, 
        direction: 'top', 
        className: 'marker-label', 
        offset: [0, -10] 
    });
    
    m.category = d.cat;
    m.on('click', () => updateUI(d));
    return m;
}

async function updateUI(d) {
    document.getElementById('event-title').textContent = d.name;
    document.getElementById('event-desc').textContent = d.desc;
    const chip = document.getElementById('voyage-chip');
    chip.textContent = d.cat;
    chip.style.background = colors[d.cat];
    
    if (window.innerWidth < 1024) document.querySelector('.content-scroll').scrollTo(0,0);

    const wikiBox = document.getElementById('wiki-box');
    const wikiImg = document.getElementById('event-img');
    wikiBox.textContent = "Bilgi getiriliyor...";

    try {
        // 1. ADIM: TÃ¼rkÃ§e Wikipedia'yÄ± dene
        let res = await fetch(`https://tr.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(d.wiki)}`);
        let data = await res.json();

        // EÄŸer TÃ¼rkÃ§e bulunamazsa veya Ã¶zet Ã§ok kÄ±saysa (hata verdiyse)
        if (data.type === "disambiguation" || data.status === 404 || !data.extract) {
            console.log("TÃ¼rkÃ§e bulunamadÄ±, Ä°ngilizce aranÄ±yor...");
            
            // 2. ADIM: Ä°ngilizce Wikipedia'yÄ± dene
            let enRes = await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(d.wiki)}`);
            let enData = await enRes.json();

            if (enData.extract) {
                // 3. ADIM: Ä°ngilizce metni TÃ¼rkÃ§eye Ã§evir
                wikiBox.textContent = "TercÃ¼me ediliyor...";
                const transRes = await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(enData.extract)}&langpair=en|tr`);
                const transData = await transRes.json();
                
                wikiBox.textContent = transData.responseData.translatedText + " (Ä°ngilizce'den Ã§evrildi)";
                
                // Resmi Ä°ngilizce maddeden al
                if (enData.thumbnail) {
                    wikiImg.src = enData.thumbnail.source;
                    wikiImg.style.display = "block";
                }
            } else {
                wikiBox.textContent = "Maalesef iki dilde de ayrÄ±ntÄ±lÄ± bilgi bulunamadÄ±.";
                wikiImg.style.display = "none";
            }
        } else {
            // TÃ¼rkÃ§e veri varsa doÄŸrudan yazdÄ±r
            wikiBox.textContent = data.extract;
            if (data.thumbnail) {
                wikiImg.src = data.thumbnail.source;
                wikiImg.style.display = "block";
            } else {
                wikiImg.style.display = "none";
            }
        }
    } catch (err) {
        console.error("Wiki HatasÄ±:", err);
        wikiBox.textContent = "Bilgi yÃ¼klenirken bir hata oluÅŸtu.";
    }

   map.flyTo([d.lat, d.lng], 7, {
    duration: 4,        // Toplam uÃ§uÅŸ sÃ¼resi
    noMoveStart: true,  // Hareket baÅŸladÄ±ÄŸÄ±nda olay tetiklemeyi durdurur (performans iÃ§in)
    easeLinearity: 0.1, // DÃ¼ÅŸÃ¼k deÄŸerler baÅŸlangÄ±Ã§ ve bitiÅŸi daha yumuÅŸak yapar
});
}

select.onchange = (e) => {
    const val = e.target.value;
    isPlaying = false;
    if (val.startsWith("ROUTE_")) {
        const cat = val.replace("ROUTE_", "");
        drawRoute(cat);
        const firstPoint = dataSet.find(d => d.cat === cat);
        if(firstPoint) updateUI(firstPoint);
    } else if (val === "RESET") {
        resetMap();
    } else {
        updateUI(dataSet[val]);
    }
};

function drawRoute(cat) {
    currentLines.forEach(l => map.removeLayer(l));
    markerNodes.forEach(m => m.category === cat ? m.addTo(map) : map.removeLayer(m));
    
    const pts = dataSet.filter(d => d.cat === cat).map(d => [d.lat, d.lng]);
    const poly = L.polyline(pts, { color: colors[cat], weight: 3, dashArray: '5, 10' }).addTo(map);
    currentLines.push(poly);
    map.fitBounds(poly.getBounds(), { padding: [30, 30] });
}

function resetMap() {
    currentLines.forEach(l => map.removeLayer(l));
    markerNodes.forEach(m => m.addTo(map));
    map.setView([20, -40], 3);
}

// Sinematik Oynatma
playBtn.addEventListener('click', async () => {
    const activeCat = document.getElementById('voyage-chip').textContent;
    if (isPlaying || !activeCat) return;
    isPlaying = true;
    playBtn.disabled = true;
    
    const points = dataSet.filter(d => d.cat === activeCat);
    for (const p of points) {
        if(!isPlaying) break;
        await updateUI(p);
        await new Promise(r => setTimeout(r, 4500));
    }
    
    playBtn.disabled = false;
    isPlaying = false;
});

init();
</script>
</body>
</html>
    
  </body>
  
</html>
